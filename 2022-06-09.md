# 9 June 2022
# or, `recs` examples

@jameshadfield [gave these examples](https://github.com/nextstrain/augur/issues/860#issuecomment-1150642112):

> I'm thinking about how we would support data that wasn't row-based (like sequences + metadata are). For instance, given the following dataset:
> 
> ID | city | latitude | longitude | lineage | lineage__color
> -- | -- | -- | -- | -- | --
> AAA | Auckland | -37 | 174 | B.1.1 | #F020E2
> BBB | Auckland | -39 | 175 | C.12 | #20C9F0
> CCC | Wellington | -41 | 174 | C.12 | #20C9F0
> 
> I've written scripts at various points in time to extract out:
> * a colours TSV mapping lineage -> hex. (Including some form of colour averaging if there are multiple hexes per lineage, which happens.)
> * A city -> lat/long TSV, which sets the lat/long based on the average of observed lat/longs for each city. Here there'd be 2 demes: Auckland, Wellington
> * A new metadata column which contains the unique lat/longs observed in the dataset, and a corresponding lat/long TSV file. Here there would be 3 demes, but we may also parametrise this to aggregate so that there are fewer. 

and [asked in
Slack](https://bedfordlab.slack.com/archives/C01LCTT7JNN/p1654804775348649)
about how one might do them with `tsv-utils` and/or `csvtk`.

I haven't used `tsv-utils` or `csvtk` much, so I offered to demonstrate in
`recs`, if that'd be helpful, given that I'd recently presented in lab meeting
on the ideas in `recs` as they related to the hypothetical `augur transform`.

## input table

```csv
ID,city,latitude,longitude,lineage,lineage__color
AAA,Auckland,-37,174,B.1.1,#F020E2
BBB,Auckland,-39,175,C.12,#20C9F0
CCC,Wellington,-41,174,C.12,#20C9F0
```

I produced this by running

    vd https://github.com/nextstrain/augur/issues/860

then selecting the correct table from the list, and then saving it to a local
CSV file.

## lineage â†’ color map

Without average, just picking the first color that appears for a lineage:

```bash
  recs fromcsv --header james-examples.csv \
| recs collate -k lineage -a color=first,lineage__color \
| recs tocsv -k lineage,color
```
